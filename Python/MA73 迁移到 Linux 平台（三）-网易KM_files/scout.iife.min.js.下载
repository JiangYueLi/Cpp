!function(){"use strict";function t(t,e,n){if(e in t){var r=t[e],o=n(r);if("function"==typeof o)try{o.prototype=o.prototype||{},Object.defineProperties(o,{__scout_original__:{enumerable:!1,value:r}})}catch(t){}t[e]=o}}function e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function r(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),o.forEach(function(n){e(t,n,r[n])})}return t}function o(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}),t}function i(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||i(t)||s(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t){return function(t){if(Array.isArray(t))return a(t)}(t)||i(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(){return"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process)}function l(){return function(){var t=function(t){return e(Math.random()*(1<<(t<<2))^Date.now()).slice(-t)},e=function(t){return(0|t).toString(16)};return[t(4)+t(4),t(4),"4"+t(3),e(8|4*Math.random())+t(3),Date.now().toString(16).slice(-10)+t(2)].join("-")}()}function h(t){return Array.isArray(t)?t:[t]}function d(t){return"string"==typeof t||n(t,String)}var p=f()?global:"undefined"!=typeof self?self:window;function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t,e){return _=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},_(t,e)}function v(t,e){return _(t,e)}function g(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}function y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function b(t,e,n){return b=y()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&v(o,n.prototype),o},b.apply(null,arguments)}function w(t,e,n){return b.apply(null,arguments)}function E(t){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},E(t)}function T(t){return E(t)}function S(t){var e="function"==typeof Map?new Map:void 0;return S=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return w(t,arguments,T(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),v(r,t)},S(t)}function R(t){return S(t)}function q(t,e){return!e||"object"!=((n=e)&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e;var n}function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=T(t);if(e){var o=T(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return q(this,n)}}var P={400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested range not satisfiable",417:"Expectation Failed",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version not supported"},D=function(t){g(n,t);var e=x(n);function n(t,r,o){var i;return m(this,n),(i=e.call(this,r||P[t])).code=t,i.__scout_xhr__=o,i.name="ScoutHttpError",i.type="httpError",i}return n}(R(Error)),L="ScoutLog";function O(t){if(!("console"in p))return t();var e=["debug","info","warn","error","log","assert"],n=p.console,r={};e.forEach(function(t){r[t]=n[t],n[t]=n[t].__scout_original__||n[t]});var o=t();return e.forEach(function(t){n[t]=r[t]}),o}var j,k,C=function(){function t(){m(this,t)}var e=t.prototype;return e._log=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];O(function(){var e;(e=p.console)[t].apply(e,["".concat(L,"[").concat(t.toUpperCase(),"]:")].concat(c(n)))})},e.log=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log.apply(this,["log"].concat(c(e)))},e.info=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log.apply(this,["info"].concat(c(e)))},e.warn=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log.apply(this,["warn"].concat(c(e)))},e.error=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log.apply(this,["error"].concat(c(e)))},e.trace=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._log.apply(this,["trace"].concat(c(e)))},t}(),A=new C;function B(t){return d(t)&&(!!t.match(/sigma-scout-oaco/)||!!t.match(/api\/test\/event/))}var I={},M={};function F(i){var a=i.type,s=i.callback;Array.isArray(I[a])||(I[a]=[]),I[a].push(s),M[a]||(M[a]=!0,function(i){switch(i){case"console":!function(){if(!("console"in p))return;["log","info","warn","error"].map(function(e){t(p.console,e,function(t){return function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];U("console",c(r).concat([e])),t&&Function.prototype.apply.call(t,p.console,r)}})})}();break;case"error":p.addEventListener("error",function(t){U("error",[t.message,t.lineno,t.colno,t.error])});break;case"unhandledrejection":f()?process.on("unhandledRejection",function(t,e){U("unhandledrejection",[t,e])}):"undefined"!=typeof window&&window.addEventListener("unhandledrejection",function(t){U("unhandledrejection",[t])});break;case"uncaughtException":f()&&process.on("uncaughtException",function(t){U("uncaughtException",[t])});break;case"history":!function(){if(!("history"in p))return;["pushState","replaceState"].forEach(function(e){t(p.history,e,function(t){return function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];U("history",c(r).concat([e])),t&&Function.prototype.apply.call(t,p.history,r)}})});var e=p.onpopstate;p.onpopstate=function(t){t.state&&U("history",[t,"popstate"]),"function"==typeof e&&e.bind(this,t)}}();break;case"hash":!function(){if(!("onhashchange"in p))return;p.addEventListener("hashchange",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];U("hash",c(e))})}();break;case"fetch":t(p,"fetch",function(t){return function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];var s=u(i,2),c=s[0],f=s[1],h=c;n(c,Request)&&(h=c.url,f={headers:c.headers,method:c.method,cache:c.cache,credentials:c.credentials,integrity:c.integrity,keepalive:c.keepalive,mode:c.mode,redirect:c.redirect,referrer:c.referrer,body:c.body,referrerPolicy:c.referrerPolicy});var d={__scout_xhr__:o(r({},f),{url:h,status_code:0,xid:l()}),args:o(r({},f),{url:h}),startTimestamp:Date.now(),endTimestamp:Date.now(),time:0,__scout_own_request__:B(c)},m=null==f?void 0:f.body;if(f&&n(f.body,FormData)&&"function"==typeof f.body.entries){m={};var _=!0,v=!1,g=void 0;try{for(var y,b=f.body.entries()[Symbol.iterator]();!(_=(y=b.next()).done);_=!0){var w=u(y.value,2),E=w[0],T=w[1];m[E]=n(T,File)?"<File>":T}}catch(t){v=!0,g=t}finally{try{_||null==b.return||b.return()}finally{if(v)throw g}}}return d.__scout_xhr__.body="object"==typeof m?JSON.stringify(m):m,U("stack-fetch",[d]),t.apply(p,i).then(function(t){if(d.__scout_own_request__)return t;d.__scout_xhr__.status_code=t.status,d.endTimestamp=Date.now(),d.time=d.endTimestamp-d.startTimestamp,d.__scout_xhr__.response_headers={},t.headers.forEach(function(t,e){d.__scout_xhr__.response_headers[e]=t});var e,n,r,o=t.status;return"".concat(o).match(/[2|3]\d{2}/)||U("error",["".concat(null!==(r=null===(e=i[1])||void 0===e||null===(n=e.method)||void 0===n?void 0:n.toUpperCase())&&void 0!==r?r:"GET"," ").concat(i[0]," ").concat(o),-1,-1,new D(o,"",d)]),t.clone().text().then(function(t){d.__scout_xhr__.response_body=t}).catch(function(){d.__scout_xhr__.response_body=void 0}).then(function(){U("fetch",[d])}),t}).catch(function(t){return t.code!==t.ABORT_ERR&&"AbortError"!==t.name&&(d.__scout_xhr__.status_code=400,d.endTimestamp=Date.now(),d.time=d.endTimestamp-d.startTimestamp,d.__scout_own_request__||U("fetch",[d])),Promise.reject(t)}).finally(function(){f=null})}});break;case"xhr":!function(){if(!("XMLHttpRequest"in globalThis))return;var i=[],a=[],s=XMLHttpRequest.prototype;t(s,"open",function(s){return function(){for(var f=arguments.length,h=new Array(f),p=0;p<f;p++)h[p]=arguments[p];var m=this,_=u(h,2),v=_[0],g=_[1];m.__scout_xhr__={method:d(v)?v.toUpperCase():v,url:g,xid:l()},U("stack-xhr",[{args:h,endTimestamp:Date.now(),startTimestamp:m.startTimestamp||Date.now(),time:Date.now()-m.startTimestamp,__scout_xhr__:m.__scout_xhr__,__scout_own_request__:m.__scout_own_request__}]),"POST"===m.__scout_xhr__.method&&B(g)&&(m.__scout_own_request__=!0);var y=function(){if(4===m.readyState){try{m.__scout_xhr__&&(m.__scout_xhr__.status_code=m.status,m.__scout_xhr__.headers=m.__scout_xhr_headers__);var t=i.indexOf(m);if(-1!==t){i.splice(t);var s=a.splice(t)[0];if(m.__scout_xhr__&&void 0!==s[0]){var u=s[0];if(n(u,FormData)){var c={};u.forEach(function(t,e){c[e]=n(t,File)?"<File>":t}),u=JSON.stringify(c)}m.__scout_xhr__.body=u}}var f=m.getAllResponseHeaders().split("\r\n").reduce(function(t,n){if(!n.trim())return t;var i=n.split(": ");return o(r({},t),e({},i[0],i[1]))},{});m.__scout_xhr__.response_headers=f,m.__scout_xhr__.response_body=m.responseText}catch(t){}0===m.status||m.__scout_own_request__||("".concat(m.status).match(/[2|3]\d{2}/)||U("error",["".concat(m.__scout_xhr__.method.toUpperCase()," ").concat(h[1]," ").concat(m.status),-1,-1,new D(m.status,"",{args:h,endTimestamp:Date.now(),startTimestamp:Date.now(),time:Date.now()-m.startTimestamp})]),U("xhr",[{args:h,endTimestamp:Date.now(),startTimestamp:m.startTimestamp||Date.now(),time:Date.now()-m.startTimestamp,__scout_xhr__:m.__scout_xhr__,__scout_own_request__:m.__scout_own_request__}]))}};"onreadystatechange"in m&&"function"==typeof m.onreadystatechange?t(m,"onreadystatechange",function(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return y(),t.apply(m,n)}}):m.addEventListener("readystatechange",y);var b=m.onerror;return m.onerror=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];if("function"==typeof b&&b.apply(void 0,c(e)),!m.__scout_own_request__){try{m.__scout_xhr__&&(m.__scout_xhr__.status_code=m.status||400,m.__scout_xhr__.headers=m.__scout_xhr_headers__);var o=i.indexOf(m);if(-1!==o){i.splice(o);var s=a.splice(o)[0];if(m.__scout_xhr__&&void 0!==s[0]){var u=s[0];if(n(u,FormData)){var f={};u.forEach(function(t,e){f[e]=n(t,File)?"<File>":t}),u=JSON.stringify(f)}m.__scout_xhr__.body=u}}}catch(t){}U("xhr",[{args:h,endTimestamp:Date.now(),startTimestamp:m.startTimestamp||Date.now(),time:Date.now()-m.startTimestamp,__scout_xhr__:m.__scout_xhr__,__scout_own_request__:m.__scout_own_request__}])}},s.apply(m,h)}}),t(s,"setRequestHeader",function(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.__scout_xhr_headers__||(this.__scout_xhr_headers__={}),this.__scout_xhr_headers__[n[0].toLowerCase()]=n[1],t.apply(this,n)}}),t(s,"send",function(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=this;i.push(this),a.push(n),this.startTimestamp=Date.now();var s=this.ontimeout;return this.ontimeout=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];"function"==typeof s&&s.apply(void 0,c(e)),U("stack-xhr",[{args:n,endTimestamp:Date.now(),startTimestamp:o.startTimestamp||Date.now(),time:Date.now()-o.startTimestamp,__scout_xhr__:o.__scout_xhr__,__scout_own_request__:o.__scout_own_request__}]),U("error",["".concat(o.__scout_xhr__.method.toUpperCase()," ").concat(o.__scout_xhr__.url," timeout"),-1,-1,new D(o.status,"",{args:n,endTimestamp:Date.now(),startTimestamp:Date.now(),time:Date.now()-o.startTimestamp})])},t.apply(this,n)}})}();break;case"dom":!function(){if(!("document"in p))return;var e=U.bind(null,"dom"),n=V(e,!0);p.document.addEventListener("click",n,!1),p.document.addEventListener("keypress",n,!1),["EventTarget","Node"].forEach(function(n){var r=p[n]&&p[n].prototype;r&&r.hasOwnProperty&&r.hasOwnProperty("addEventListener")&&(t(r,"addEventListener",function(t){return A.info(t),function(n,r,o){if(["click","keypress"].includes(n)&&this)try{var i=this,a=i.__scout_instrument_handlers__=i.__scout_instrument_handlers__||{},s=a[n]=a[n]||{refCount:0};if(!s.handler){var u=V(e);s.handler=u,t.call(this,n,u,o)}s.refCount+=1}catch(t){}t.call(this,n,r,o)}}),t(r,"removeEventListener",function(t){return function(e,n,r){if(["click","keypress"].includes(e)&&this){var o=this,i=o.__scout_instrument_handlers__||{},a=i[e];a&&(a.refCount-=1,a.refCount<=0&&(t.call(this,e,a.handler,r),a.handler=void 0,delete i[e]),0===Object.keys(i).length&&delete o.__scout_instrument_handlers__)}t.call(this,e,n,r)}}))})}()}}(a))}function U(t,e){if(Array.isArray(I[t])){var n=!0,r=!1,o=void 0;try{for(var i,a=I[t][Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s;(s=i.value).call.apply(s,[null].concat(c(e)))}}catch(t){r=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}}function N(t){if("keypress"!==t.type)return!1;try{var e=t.target;if(!e||!e.tagName)return!0;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName||e.isContentEditable)return!1}catch(t){}return!0}function H(t,e){if(!t)return!0;if(t.type!==e.type)return!0;try{if(t.target!==e.target)return!0}catch(t){}return!1}function V(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){if(n&&j!==n&&!N(n)){var r="keypress"===n.type?"input":n.type;(void 0===k||H(j,n))&&(t([{event:n,name:r,global:e}]),j=n),clearTimeout(k),k=p.setTimeout(function(){k=void 0},3e3)}}}function z(t){var e={},n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,u=s.stacktrace,c=s.url,f=s.msg,l="".concat(u,"_").concat(c,"_").concat(f);e[l]||(e[l]=[]),e[l].push(s)}}catch(t){r=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}var h=[];return Object.keys(e).forEach(function(t){var n=e[t][0];e[t].length>1&&(n.count=e[t].length),h.push(n)}),h}function G(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function J(t,e,n){return e&&G(t.prototype,e),n&&G(t,n),t}var W=function(){function t(){m(this,t),this.buffers=[],this.limitCount=20,this.isClosed=!1,this.pendingList=[],this.timer=-1,this.runPending()}var e=t.prototype;return e.runPending=function(){var t=this;p.clearInterval(this.timer),this.timer=p.setInterval(function(){0===t.buffers.length&&t.pendingList.splice(0,Math.floor(t.limitCount/2)).forEach(function(e){t.add(e)})},1e3)},e.isValid=function(){return this.limitCount&&this.buffers.length<this.limitCount},e.add=function(t){var e=this;if(!this.isValid())return A.warn("request limit count!!!"),this.pendingList.push(t),Promise.resolve(null);if(this.isClosed)return A.warn("buffers drain!!!"),Promise.resolve(null);t.__scout_pending__&&A.info("pending request running");var n=t();return this.buffers.includes(n)||this.buffers.push(n),n.then(function(){e.remove(n)}),n},e.remove=function(t){this.buffers.includes(t)&&this.buffers.splice(this.buffers.indexOf(t),1)},e.close=function(t){var e=this;return new Promise(function(n){if(t<0)e.isClosed=!1,p.clearInterval(e.timer),n(!0);else var r=setTimeout(function(){clearTimeout(r),e.isClosed=!1,e.runPending(),n(!0)},t)})},J(t,[{key:"length",get:function(){return this.buffers.length}}]),t}();R(Error);var X=function(){return new Promise(function(t,e){var r,o=function(e){t({isPrivate:e,browserName:c})},i=function(t){return t===eval.toString().length},a=function(){void 0!==navigator.maxTouchPoints?function(){var t=String(Math.random());try{window.indexedDB.open(t,1).onupgradeneeded=function(e){var r,i=null===(r=e.target)||void 0===r?void 0:r.result;try{i.createObjectStore("test",{autoIncrement:!0}).put(new Blob),o(!1)}catch(t){var a,s=t;if(n(t,Error)&&(s=null!==(a=t.message)&&void 0!==a?a:t),"string"!=typeof s)return o(!1);var u=/BlobURLs are not yet supported/.test(s);return o(u)}finally{i.close(),window.indexedDB.deleteDatabase(t)}}}catch(t){return o(!1)}}():function(){var t=window.openDatabase,e=window.localStorage;try{t(null,null,null,null)}catch(t){return o(!0)}try{e.setItem("test","1"),e.removeItem("test")}catch(t){return o(!0)}o(!1)}()},s=function(){navigator.webkitTemporaryStorage.queryUsageAndQuota(function(t,e){var n=Math.round(e/1048576),r=2*Math.round(function(){var t=window;return void 0!==t.performance&&void 0!==t.performance.memory&&void 0!==t.performance.memory.jsHeapSizeLimit?performance.memory.jsHeapSizeLimit:1073741824}()/1048576);o(n<r)},function(t){e(new Error("detectIncognito somehow failed to query storage quota: "+t.message))})},u=function(){void 0!==self.Promise&&void 0!==self.Promise.allSettled?s():(0,window.webkitRequestFileSystem)(0,1,function(){o(!1)},function(){o(!0)})},c="Unknown";(function(){var t=navigator.vendor;return void 0!==t&&0===t.indexOf("Apple")&&i(37)})()?(c="Safari",a()):function(){var t=navigator.vendor;return void 0!==t&&0===t.indexOf("Google")&&i(33)}()?(r=navigator.userAgent,c=r.match(/Chrome/)?void 0!==navigator.brave?"Brave":r.match(/Edg/)?"Edge":r.match(/OPR/)?"Opera":"Chrome":"Chromium",u()):void 0!==document.documentElement&&void 0!==document.documentElement.style.MozAppearance&&i(37)?(c="Firefox",o(void 0===navigator.serviceWorker)):void 0!==navigator.msSaveBlob&&i(39)?(c="Internet Explorer",o(void 0===window.indexedDB)):e(new Error("detectIncognito cannot determine the browser"))})},Q=function(t,e){return Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Q(t,e)};function $(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Q(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var K=function(){return K=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},K.apply(this,arguments)};function Y(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}u((r=r.apply(t,e||[])).next())})}function Z(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function tt(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function et(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}function nt(){return nt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},nt.apply(this,arguments)}var rt=function(){function t(){m(this,t)}var e=t.prototype;return e.sendEvent=function(t){return Promise.resolve("no request")},e.close=function(t){return Promise.resolve("no close")},e.getRequestBufferLen=function(){return 0},e.popFailRequest=function(){return null},t}(),ot={limitTimeout:1e3},it=function(){function t(e,n){m(this,t),this.version=n,this.config={},this.maxResourceSize=30,this.pageId=l(),this.config=nt({},ot,e),this.requestObj=this.getRequestMethod()}var e=t.prototype;return e.getConfig=function(){return this.config},e.getRequestMethod=function(){return this.requestObj?this.requestObj:new rt},e.getLocationInfo=function(){return{pathname:"",protocol:"",origin:"",url:""}},e.getRequestBuffersLen=function(){return this.requestObj.getRequestBufferLen()},e.popFailRequest=function(){var t;return null===(t=this.requestObj)||void 0===t?void 0:t.popFailRequest()},e.afterParsed=function(t){return Array.isArray(t.errors)&&t.errors.forEach(function(t){delete t.__scout_error__}),t},e._sendData=function(t,e){var n=this;return new Promise(function(e){var r=n.getConfig().beforeSend;"function"==typeof r?e(r(t)):e(t)}).then(function(t){(t=n.afterParsed(t))&&n.requestObj&&"function"==typeof n.requestObj.sendEvent?n.requestObj.sendEvent(t,e):A.warn("requestBody is not send")}).catch(function(t){A.error(t.toString())})},e.sendErrors=function(t,e){var n=this.buildRequestBody(t,"error",e);Array.isArray(n.errors)&&n.errors.length>0&&(n.errors.forEach(function(t){return t.traceFrames=[]}),this._sendData(n))},e.sendPerformance=function(t,e){var n=this.buildRequestBody([],"performance",r({performance:{name:t.name,data:t}},e));this._sendData(n,!0)},e.sendMsg=function(t,e){var n=this.buildRequestBody([],"info",r({messages:h(t)},e));this._sendData(n)},e.sendRequestLog=function(t,e){for(;t.length;){var n=t.splice(0,this.maxResourceSize),o=this.buildRequestBody([],"requestLog",r({requestLog:n},e));this._sendData(o)}},e.sendResourceTiming=function(t,e){for(;t.length;){var n=t.splice(0,this.maxResourceSize),o=this.buildRequestBody([],"resourceTiming",r({timings:n},e));this._sendData(o)}},e.generateBaseRequestBody=function(){return{}},e.buildRequestBody=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error",n=arguments.length>2?arguments[2]:void 0,o=this.getConfig().appId,i=Array.isArray(t)?t:[t];return r({errors:i,type:e,appId:o,pageId:this.pageId,eventId:l(),timestamp:Date.now(),paths:[],userData:{},metaData:{}},this.generateBaseRequestBody(),n)},e.tapError=function(t,e){return t},e.close=function(t){return this.requestObj.close(t)},J(t,[{key:"request",get:function(){return this.requestObj}}]),t}(),at=function(){function t(e){m(this,t),this.resourceTimings=[],this.errors=[],this.spans=[],this.breadcrumbs=[],this.paths=[],this.messages=[],this.client=e,this.interactions=[],this.requestLogs=[],this.pendingRequestLogs=[]}var e=t.prototype;return e.addBreadcrumbs=function(t,e){var n=this.client.getConfig(),r=n.maxBreadcrumbs,o=void 0===r?15:r,i=n.sampleRate,a=void 0===i?1:i,s=n.beforeBreadcrumb;if(Math.random()<=a){var u,f={type:t,event:e,timestamp:null!==(u=e.timestamp)&&void 0!==u?u:Date.now()},l="function"==typeof s?s(f):f;l&&(this.breadcrumbs=c(this.breadcrumbs).concat([l]).slice(-o))}},e.addErrors=function(t){var e=this.client.getConfig(),n=e.maxErrors,r=void 0===n?30:n,o=e.sampleRate,i=void 0===o?1:o;if((!t.reason||!t.reason.__CANCEL__&&"AbortError"!==t.reason.name)&&Math.random()<=i&&this.errors.length<r){if(!(t=this.parseError(t))||this.isExcludeUrl(t)||!this.isValidError(t))return;this.errors.push(t)}},e.flushInterAction=function(){this.interactions=[]},e.addInteraction=function(t,e){var n=this.client.getConfig().ignoreInteraction;if(e||this.isValidEvent(t)){if("function"==typeof n&&!n(t))return;this.interactions.push(t)}},e.isExcludeUrl=function(t){var e=this.client.getConfig().excludeUrls;return!!(Array.isArray(e)&&e.length>0)&&t.traceFrames.some(function(t){return e.some(function(e){return"string"==typeof e?t.url.includes(e):"[object RegExp]"===Object.prototype.toString.call(e)&&e.exec(t.url)})})},e.isValidError=function(t){var e=this.client.getConfig().ignoreErrors;if("ScoutError"===t.errorType||t.msg&&"string"==typeof t.msg&&t.msg.match("ResizeObserver loop limit exceeded"))return!1;if(!Array.isArray(e))return!0;var n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s,u=i.value;if("string"==typeof u&&"string"==typeof t.msg&&(null===(s=t.msg)||void 0===s?void 0:s.includes(u)))return!1;if("string"==typeof t.msg&&"[object RegExp]"===Object.prototype.toString.call(u)&&u.exec(t.msg))return!1;if("function"==typeof u&&u(t))return!1}}catch(t){r=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return!0},e.isValidEvent=function(t){return 3!==t.type||1!==t.data.source},e.isValidMsg=function(t){var e=this.client.getConfig().ignoreMessage;return"function"!=typeof e||!e(t)},e.addPath=function(t){for(;this.paths.length>=100;)this.paths.shift();this.addBreadcrumbs("navigation",{to:t,from:this.paths[0]}),this.paths.unshift(t)},e.formatMsg=function(t,e,n){return{msg:t,type:e||"custom",scope:null!=n?n:"default",url:this.client.getLocationInfo().url,timestamp:Date.now(),breadcrumbs:this.breadcrumbs}},e.addMessage=function(t){var e="string"==typeof t?t:t.msg,n="string"==typeof t?"default":t.scope,r="object"==typeof t?null==t?void 0:t.type:"";try{"object"==typeof e&&(e=JSON.stringify(e))}catch(t){A.error(t),e=String(e)}this.isValidMsg(e)&&this.messages.push(this.formatMsg(e,r,n))},e.flush=function(){return this.errors.splice(0)},e.flushPaths=function(){return this.paths.splice(0)},e.flushMessage=function(){return this.messages.splice(0,5)},e.setUserData=function(t){this.userData=t},e.setMetaData=function(t){this.metaData=t},e.parseStackFrames=function(t){if(!t)return[];var e=t.split(/\r?\n/g).slice(1),n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value,c=(u=u.trim()).match(/at ([^\s]+)\s\((.*)(\:(\d{1,}):(\d{1,}))\)$/);c&&n.push({url:c[2],func:c[1],lineno:parseInt(c[4]),colno:parseInt(c[5]),beforeParsed:u})}}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n},e.parseError=function(t){var e,n,r,o,i,a,s,u,c;if("unhandledrejection"===t.type)e={msg:null!==(a=null===(n=t.reason)||void 0===n?void 0:n.message)&&void 0!==a?a:t.reason,timestamp:Date.now(),stacktrace:null!==(s=null===(r=t.reason)||void 0===r?void 0:r.stack)&&void 0!==s?s:"",type:t.type,traceFrames:this.parseStackFrames(null!==(u=null===(o=t.reason)||void 0===o?void 0:o.stack)&&void 0!==u?u:""),errorType:null!==(c=null==t||null===(i=t.reason)||void 0===i?void 0:i.name)&&void 0!==c?c:"Error"};else if(t.error&&"ScoutHttpError"===t.error.name){var f,h,d;e={msg:t.msg,timestamp:Date.now(),stacktrace:null!==(d=null==t||null===(f=t.error)||void 0===f?void 0:f.stack)&&void 0!==d?d:"",type:"httpError",traceFrames:[],errorType:null==t||null===(h=t.error)||void 0===h?void 0:h.name,__scout_xhr__:t.error.__scout_xhr__}}else if(t.error){var p;e={msg:t.msg,timestamp:Date.now(),stacktrace:t.error.stack,type:"error",traceFrames:this.parseStackFrames(t.error.stack),errorType:null==t||null===(p=t.error)||void 0===p?void 0:p.name}}else{var m,_;e={msg:t.msg,timestamp:Date.now(),stacktrace:null==t||null===(m=t.error)||void 0===m?void 0:m.stack,errorType:"",type:t.type,traceFrames:this.parseStackFrames(null==t||null===(_=t.error)||void 0===_?void 0:_.stack)}}return e.msg=(e.msg||"").toString(),e.eventId=l(),e.url=this.client.getLocationInfo().url,e.type=e.type||"unknown",e.errorType=e.errorType||"UnknownError",e.__scout_error__=t,"function"==typeof this.client.tapError&&(e=this.client.tapError(e,t)),e},e.capturePopoError=function(t){return{msg:"string"==typeof t?t:t.message,timestamp:Date.now(),stacktrace:"string"==typeof t?"":t.stack||"",traceFrames:[],type:"customError",errorType:n(t,Error)?t.name:"PopoError",eventId:l(),url:""}},e.captureError=function(t){var e={msg:"string"==typeof t?t:t.message,timestamp:Date.now(),stacktrace:"string"==typeof t?"":t.stack||"",traceFrames:[],type:"customError",errorType:"string"==typeof t?"":t.name||"",eventId:l(),url:this.client.getLocationInfo().url};return e.__scout_error__=t,e},e.captureSpans=function(t){this.spans.length>50&&this.spans.splice(0,this.spans.length-50),this.spans.push(t)},e.flushSpans=function(){return this.spans.splice(0)},e.captureRequest=function(t){var e=this.client.getConfig().ignoreRequestMsg;t.__scout_own_request__||e&&("function"!=typeof e||e(t))||this.captureSpans({type:"request",endTimestamp:t.endTimestamp,startTimestamp:t.startTimestamp,time:t.time,__scout_xhr__:t.__scout_xhr__?{headers:t.__scout_xhr__.headers,method:t.__scout_xhr__.method,response_headers:t.__scout_xhr__.response_headers,status_code:t.__scout_xhr__.status_code,url:t.__scout_xhr__.url}:null})},e.patchRequestUrl=function(t){var e=this.client.getLocationInfo();if(!/^https?:\/\//.test(t)){if(t.startsWith("//"))return e.protocol+t;if(t.startsWith("/"))return e.origin+t;var n=e.origin+e.pathname;return n+(n.endsWith("/")?"":"/")+t}return t},e.generateRequestLogRoute=function(t){var e=this.client.getConfig(),r=e.requestLogLevel,o=e.routeMap,i=t,a=null;try{a=new URL(t),i=5===r?a.origin:"".concat(a.protocol,"//").concat(a.host).concat(a.pathname)}catch(t){}if("undefined"!=typeof Map&&n(o,Map)){var s=!0,u=!1,c=void 0;try{for(var f,l=o.keys()[Symbol.iterator]();!(s=(f=l.next()).done);s=!0){var h=f.value;if(n(h,RegExp)?h.test(t):"string"==typeof h&&t.includes(h)){var d=o.get(h);i="function"==typeof d?d(i,h):d;break}}}catch(t){u=!0,c=t}finally{try{s||null==l.return||l.return()}finally{if(u)throw c}}}else if("object"==typeof o){var p=o,m=!0,_=!1,v=void 0;try{for(var g,y=Object.keys(p)[Symbol.iterator]();!(m=(g=y.next()).done);m=!0){var b=g.value;if(t.includes(b)){var w=p[b];i="function"==typeof w?w(i,b):w;break}}}catch(t){_=!0,v=t}finally{try{m||null==y.return||y.return()}finally{if(_)throw v}}}return!i&&a&&(i=5===r?a.origin:"".concat(a.protocol,"//").concat(a.host).concat(a.pathname)),i},e.getResponseBody=function(t){var e,n=null===(e=t.__scout_xhr__.response_headers)||void 0===e?void 0:e["content-type"];return n&&["image/"].findIndex(function(t){return n.includes(t)})>-1?null:t.__scout_xhr__.response_body},e.generateRequestLog=function(t){var e,n,i=this.client.getConfig(),a=i.requestLogLevel,s=i.requestBussinessStatusCodeKey,u=this.patchRequestUrl(t.__scout_xhr__.url),c=u;try{var f=new URL(u);c=5===a?f.origin:4===a?"".concat(f.protocol,"//").concat(f.host).concat(f.pathname):u}catch(t){}var h=this.getResponseBody(t),d={url:c,route:this.generateRequestLogRoute(u),method:t.__scout_xhr__.method||"GET",requestHeaders:o(r({},t.__scout_xhr__.headers),{cookie:void 0}),requestBody:a<=1?t.__scout_xhr__.body:void 0,responseHeaders:t.__scout_xhr__.response_headers,responseBody:0===a?h:"",startTime:t.startTimestamp,endTime:t.endTimestamp,statusCode:t.__scout_xhr__.status_code,bussinessStatusCode:"",referrer:this.client.getLocationInfo().url,requestId:l()};if(s&&(null===(e=d.responseHeaders)||void 0===e||null===(n=e["content-type"])||void 0===n?void 0:n.includes("application/json")))try{var p,m=JSON.parse(t.__scout_xhr__.response_body);d.bussinessStatusCode=(null!==(p="string"==typeof s?m[s]:s(d,t,m))&&void 0!==p?p:"")+""}catch(t){A.warn("fail to parse response from ".concat(c))}return d},e.removePendingRequest=function(t){var e=t.__scout_xhr__.xid,n=this.pendingRequestLogs.findIndex(function(t){return t.__scout_xhr__.xid===e});n>-1&&this.pendingRequestLogs.splice(n,1)},e.captureRequestLog=function(t,e){var n=this.client.getConfig(),r=n.beforeSendRequestLog,o=n.ignoreRequestMsg,i=t;if(!i.__scout_own_request__&&i.__scout_xhr__&&"string"==typeof i.__scout_xhr__.url&&!i.__scout_xhr__.url.includes("hubble.netease.com")&&(!o||"function"==typeof o&&!o(i))){this.removePendingRequest(i);var a=this.generateRequestLog(i);"function"==typeof r&&(a=r(a,i)),a&&(this.requestLogs.push(a),this.addBreadcrumbs(e,{requestId:a.requestId,url:a.url,statusCode:a.statusCode,method:a.method,timestamp:i.startTimestamp}))}i=null},e.flushRequestLogs=function(){return this.requestLogs.splice(0)},e.flushPendingRequest=function(){var t=this,e=this.client.getConfig().beforeSendRequestLog;return this.pendingRequestLogs.map(function(e){return{requestLog:t.generateRequestLog(e),request:e}}).filter(function(t){var n=t.request,r=t.requestLog;return"function"==typeof e&&(r=e(r,n)),!!r}).map(function(t){return t.requestLog})},e.capturePendingRequest=function(t,e){var n=this.client.getConfig().ignoreRequestMsg,r=t;r.__scout_own_request__||!r.__scout_xhr__||"string"!=typeof r.__scout_xhr__.url||r.__scout_xhr__.url.includes("hubble.netease.com")||n&&("function"!=typeof n||n(r))||this.pendingRequestLogs.push(r)},e.captureResourceTimings=function(t){var e,n=this.client.getConfig().ignoreResourceTiming;t=t.filter(function(t){var e=!B(t.name);return"function"==typeof n&&(e=!n(t)),e}),(e=this.resourceTimings).push.apply(e,c(t.map(this.formatPerformanceEntry)))},e.flushResourceTimings=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,e=-1===t?this.resourceTimings.length:t;return this.resourceTimings.splice(0,e)},e.formatPerformanceEntry=function(t){var e=new URL(t.name);return{startTime:t.startTime||0,redirectStart:t.redirectStart||0,redirectEnd:t.redirectEnd||0,fetchStart:t.fetchStart||0,domainLookupStart:t.domainLookupStart||0,domainLookupEnd:t.domainLookupEnd||0,connectStart:t.connectStart||0,secureConnectionStart:t.secureConnectionStart||0,connectEnd:t.connectEnd||0,requestStart:t.requestStart||0,responseStart:t.responseStart||0,responseEnd:t.responseEnd||0,duration:t.duration||0,route:"".concat(e.origin).concat(e.pathname),url:t.name,encodedBodySize:t.encodedBodySize||0,decodedBodySize:t.decodedBodySize||0,transferSize:t.transferSize||0,entryType:t.entryType,resourceType:t.type||"",initiatorType:t.initiatorType||"",timestamp:Date.now()-parseInt(performance.now()-t.startTime),responseStatus:t.responseStatus}},e.generateDOMTarget=function(t){var e=t.id,n=t.classList,r=t.tagName,o=[];e&&o.push("#".concat(e)),n&&n.forEach(function(t){t&&o.push(".".concat(t))});var i=t.getAttribute("name");return null!=i&&""!==i&&o.push('[name="'.concat(i,'"]')),"".concat(r.toLocaleLowerCase()).concat(o.join(""))},e.generatePathDOMTarget=function(t){if(!t)return null;for(var e=[],n=t;n&&n!==document.documentElement;){var r=this.generateDOMTarget(n);r&&e.unshift(r),n=n.parentElement}return e.join(" > ")},e.captureDOM=function(t){var e=t.event,r=t.name,o=e.target;n(o,Element)&&this.addBreadcrumbs(r,{target:this.generatePathDOMTarget(o),eventName:r})},e.captureLog=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";this.addBreadcrumbs("log",{msg:t,level:e})},t}(),st=function(t){g(n,t);var e=x(n);function n(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];var i;return m(this,n),(i=e.call.apply(e,[this].concat(c(r)))).name="ScoutError",i}return n}(R(Error)),ut=function(){function t(e,n){var r,o,i;m(this,t),this.url="https://sigma-scout-oaco.proxima.nie.netease.com/",this.limitTimeout=e,this._buffers=new W,this._errorBuffers=new W,this._failQueue=[],this.client=n,this.lastRequestTime=Date.now(),this.url=null!==(i=null===(o=null===(r=this.client)||void 0===r?void 0:r.getConfig())||void 0===o?void 0:o.requestUrl)&&void 0!==i?i:this.url}var e=t.prototype;return e.sendEvent=function(t,e){return Promise.reject("_sendEvent must be defined")},e.close=function(t){return this._buffers.close(t)},e.isValidTimeout=function(t){return this.lastRequestTime+this.limitTimeout<=t},e.getRequestBufferLen=function(){return this._buffers.length},e.popFailRequest=function(){return this._failQueue.shift()},e.putFailRequestToBuffer=function(t){var e=this;this._errorBuffers.add(function(){return new Promise(function(n){t.repeat=t.repeat?t.repeat+1:1,e._failQueue.push(t),n(void 0)})})},t}(),ct=function(t){g(n,t);var e=x(n);function n(){return m(this,n),e.apply(this,arguments)}var r=n.prototype;return r.sendEvent=function(t,e){return this._sendEvent(t,e)},r.bindRequest=function(t){this.customRequest=t},r._sendEvent=function(t,e){var n=this;return e||this.isValidTimeout(t.timestamp)?this._buffers.add(function(){return e||(n.lastRequestTime=t.timestamp),new Promise(function(e){"function"==typeof n.customRequest&&n.customRequest(t,e,function(){n.putFailRequestToBuffer(t),e(void 0)})})}):(this.putFailRequestToBuffer(t),Promise.reject(new st("request limit time")))},n}(ut),ft=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";m(this,t),this.hub=e,this.scope=n}var e=t.prototype;return e.setScope=function(t){this.scope=t},e.withScope=function(e){return new t(this.hub,e)},e._log=function(t,e){var n="string"==typeof e?{scope:this.scope,message:e}:e;this.hub.addMessage({type:t,scope:n.scope,msg:n.message,timestamp:Date.now()})},e.log=function(t){this._log("log",t)},e.info=function(t){this._log("info",t)},e.warning=function(t){this._log("warning",t)},e.error=function(t){this._log("error",t)},e.trace=function(t){this._log("trace",t)},t}(),lt={};!function(t){Object.defineProperty(t,"__esModule",{value:!0}),function(t,e){for(var n in e)Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}(t,{excludeUrls:function(){return e},ignoreErrors:function(){return n},instrumentEnable:function(){return r},limitPaths:function(){return o},limitTimeout:function(){return i},errorRepeat:function(){return a},requestLogLevel:function(){return s},enabled:function(){return u},maxBreadcrumbs:function(){return c},maxErrors:function(){return f},MAX_BREADCRUMBS:function(){return l}});var e=[/^chrome:/,/^chrome-extension/],n=["ScoutError"],r={error:!0,console:!1,uncaughtException:!0,unhandledrejection:!0,hash:!0,history:!0,fetch:!1,xhr:!1,resourceTiming:!0,dom:!1},o=10,i=1e3,a=3,s=2,u=!0,c=15,f=30,l=100}(lt);var ht,dt,pt,mt,_t=function(t,e){return{name:t,value:void 0===e?-1:e,delta:0,entries:[],id:"v2-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},vt=function(t,e){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){if("first-input"===t&&!("PerformanceEventTiming"in self))return;var n=new PerformanceObserver(function(t){return t.getEntries().map(e)});return n.observe({type:t,buffered:!0}),n}}catch(t){}},gt=function(t,e){var n=function n(r){"pagehide"!==r.type&&"hidden"!==document.visibilityState||(t(r),e&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},yt=function(t){addEventListener("pageshow",function(e){e.persisted&&t(e)},!0)},bt=function(t,e,n){var r;return function(o){e.value>=0&&(o||n)&&(e.delta=e.value-(r||0),(e.delta||void 0===r)&&(r=e.value,t(e)))}},wt=-1,Et=function(){return"hidden"===document.visibilityState?0:1/0},Tt=function(){gt(function(t){var e=t.timeStamp;wt=e},!0)},St=function(){return wt<0&&(wt=Et(),Tt(),yt(function(){setTimeout(function(){wt=Et(),Tt()},0)})),{get firstHiddenTime(){return wt}}},Rt=function(t,e){var n,r=St(),o=_t("FCP"),i=function(t){"first-contentful-paint"===t.name&&(s&&s.disconnect(),t.startTime<r.firstHiddenTime&&(o.value=t.startTime,o.entries.push(t),n(!0)))},a=window.performance&&performance.getEntriesByName&&performance.getEntriesByName("first-contentful-paint")[0],s=a?null:vt("paint",i);(a||s)&&(n=bt(t,o,e),a&&i(a),yt(function(r){o=_t("FCP"),n=bt(t,o,e),requestAnimationFrame(function(){requestAnimationFrame(function(){o.value=performance.now()-r.timeStamp,n(!0)})})}))},qt=!1,xt=-1,Pt=function(t,e){qt||(Rt(function(t){xt=t.value}),qt=!0);var n,r=function(e){xt>-1&&t(e)},o=_t("CLS",0),i=0,a=[],s=function(t){if(!t.hadRecentInput){var e=a[0],r=a[a.length-1];i&&t.startTime-r.startTime<1e3&&t.startTime-e.startTime<5e3?(i+=t.value,a.push(t)):(i=t.value,a=[t]),i>o.value&&(o.value=i,o.entries=a,n())}},u=vt("layout-shift",s);u&&(n=bt(r,o,e),gt(function(){u.takeRecords().map(s),n(!0)}),yt(function(){i=0,xt=-1,o=_t("CLS",0),n=bt(r,o,e)}))},Dt={passive:!0,capture:!0},Lt=new Date,Ot=function(t,e){ht||(ht=e,dt=t,pt=new Date,Ct(removeEventListener),jt())},jt=function(){if(dt>=0&&dt<pt-Lt){var t={entryType:"first-input",name:ht.type,target:ht.target,cancelable:ht.cancelable,startTime:ht.timeStamp,processingStart:ht.timeStamp+dt};mt.forEach(function(e){e(t)}),mt=[]}},kt=function(t){if(t.cancelable){var e=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;"pointerdown"==t.type?function(t,e){var n=function(){Ot(t,e),o()},r=function(){o()},o=function(){removeEventListener("pointerup",n,Dt),removeEventListener("pointercancel",r,Dt)};addEventListener("pointerup",n,Dt),addEventListener("pointercancel",r,Dt)}(e,t):Ot(e,t)}},Ct=function(t){["mousedown","keydown","touchstart","pointerdown"].forEach(function(e){return t(e,kt,Dt)})},At=function(t,e){var n,r=St(),o=_t("FID"),i=function(t){t.startTime<r.firstHiddenTime&&(o.value=t.processingStart-t.startTime,o.entries.push(t),n(!0))},a=vt("first-input",i);n=bt(t,o,e),a&&gt(function(){a.takeRecords().map(i),a.disconnect()},!0),a&&yt(function(){var r;o=_t("FID"),n=bt(t,o,e),mt=[],dt=-1,ht=null,Ct(addEventListener),r=i,mt.push(r),jt()})},Bt={},It=function(t,e){var n,r=St(),o=_t("LCP"),i=function(t){var e=t.startTime;e<r.firstHiddenTime&&(o.value=e,o.entries.push(t),n())},a=vt("largest-contentful-paint",i);if(a){n=bt(t,o,e);var s=function(){Bt[o.id]||(a.takeRecords().map(i),a.disconnect(),Bt[o.id]=!0,n(!0))};["keydown","click"].forEach(function(t){addEventListener(t,s,{once:!0,capture:!0})}),gt(s,!0),yt(function(r){o=_t("LCP"),n=bt(t,o,e),requestAnimationFrame(function(){requestAnimationFrame(function(){o.value=performance.now()-r.timeStamp,Bt[o.id]=!0,n(!0)})})})}},Mt=function(t){var e,n=_t("TTFB");e=function(){try{var e=performance.getEntriesByType("navigation")[0]||function(){var t=performance.timing,e={entryType:"navigation",startTime:0};for(var n in t)"navigationStart"!==n&&"toJSON"!==n&&(e[n]=Math.max(t[n]-t.navigationStart,0));return e}();if(n.value=n.delta=e.responseStart,n.value<0||n.value>performance.now())return;n.entries=[e],t(n)}catch(t){}},"complete"===document.readyState?setTimeout(e,0):addEventListener("load",function(){return setTimeout(e,0)})},Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $(e,t),e.prototype.sendEvent=function(t,e){return this._sendEvent(t,e)},e.prototype._sendEvent=function(t,e){var n=this;if(!e&&!this.isValidTimeout(t.timestamp))return this.putFailRequestToBuffer(t),Promise.reject(new st("request limit time"));var r=this.client.getConfig().onSuccess;try{var o=JSON.stringify(t);return this._buffers.add(function(){return e||(n.lastRequestTime=t.timestamp),new Promise(function(e){var i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&(200!==i.status&&201!==i.status?n.putFailRequestToBuffer(t):"function"==typeof r&&r(i),e(void 0))};var a=n.url;n.url.includes("?")?a+="&t=".concat(Date.now()):a+="?t=".concat(Date.now()),i.open("POST",a),i.setRequestHeader("Content-Type","application/json;charset=utf-8"),i.send(o)})})}catch(t){return Promise.reject(new st(t.toString()))}},e}(ut),Ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $(e,t),e.prototype.sendEvent=function(t,e){return this._sendEvent(t,e)},e.prototype._sendEvent=function(t,e){var n=this;if(!e&&!this.isValidTimeout(t.timestamp))return this.putFailRequestToBuffer(t),Promise.reject(new st("request limit time"));var r=this.client.getConfig().onSuccess;try{var o=JSON.stringify(t);return this._buffers.add(function(){return e||(n.lastRequestTime=t.timestamp),new Promise(function(e){var i=n.url;n.url.includes("?")?i+="&t=".concat(Date.now()):i+="?t=".concat(Date.now()),fetch(i,{method:"post",body:o,headers:{"Content-Type":"application/json;charset=utf-8"}}).then(function(o){200!==o.status&&201!==o.status&&n.putFailRequestToBuffer(t),e(o),"function"==typeof r&&r(o)}).catch(function(r){A.error(r),n.putFailRequestToBuffer(t),e(r)})})})}catch(t){return Promise.reject(new st(t.toString()))}},e}(ut),Nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $(e,t),e.prototype.sendEvent=function(t,e){return this._sendEvent(t,e)},e.prototype._sendEvent=function(t,e){var n=this;if(!e&&!this.isValidTimeout(t.timestamp))return this.putFailRequestToBuffer(t),Promise.reject(new st("request limit time"));var r=this.client.getConfig().onSuccess;try{var o=JSON.stringify(t);return this._buffers.add(function(){return e||(n.lastRequestTime=t.timestamp),new Promise(function(e,i){var a=n.url;n.url.includes("?")?a+="&t=".concat(Date.now()):a+="?t=".concat(Date.now());var s=navigator.sendBeacon(a,o);"function"==typeof r&&r(s),s?e(void 0):(A.warn("beacon send fail"),n.putFailRequestToBuffer(t),e(new st("beacon send fail")))})})}catch(t){return Promise.reject(new st(t.toString()))}},e}(ut),Ht="0.0.88",Vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $(e,t),e.prototype.getLocationInfo=function(){return{url:window.location.href,protocol:window.location.protocol,origin:window.location.origin,pathname:window.location.pathname}},e.prototype.generateBaseRequestBody=function(){return{sdk:{version:Ht,platform:"javascript"},referrer:document.referrer,ua:navigator.userAgent,viewport:{w:window.innerWidth,h:window.innerHeight,r:window.devicePixelRatio,f:0},url:location.href}},e.prototype.isIosSafari=function(){return window.navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)},e.prototype.getRequestMethod=function(){var t=this.getConfig(),e=t.limitTimeout,n=void 0===e?1e3:e,r=t.request,o=t.useMethod;if("function"==typeof r){var i=new ct(n,this);return i.bindRequest(r),i}return"function"!=typeof navigator.sendBeacon||"fetch"===o||"xhr"===o||this.isIosSafari()?"function"!=typeof window.fetch||["xhr","beacon"].includes(o)?new Ft(0,this):new Ut(0,this):new Nt(0,this)},e.prototype.getVitalsData=function(t,e){var n=this;"function"==typeof t&&t(function(t){n.sendPerformance({value:t.value,name:t.name,delta:t.delta},e)})},e.prototype.getBasicPerformanceData=function(t){var e=window.performance.timing;if(e){var n={redirect:e.redirectEnd?e.redirectEnd-e.navigationStart:0,appCache:e.domainLookupStart-e.fetchStart,dns:e.domainLookupEnd-e.domainLookupStart,tcp:e.connectEnd-e.connectStart,request:e.responseStart-e.requestStart,response:e.responseEnd-e.responseStart,domInteractive:e.domInteractive-e.navigationStart,domReady:e.domComplete?e.domComplete-e.navigationStart:0,load:e.loadEventEnd?e.loadEventEnd-e.navigationStart:0};this.sendPerformance(K({name:"timing"},n),t)}},e.prototype.getPerformanceData=function(t){this.getVitalsData(Pt,t),this.getVitalsData(At,t),this.getVitalsData(It,t),this.getVitalsData(Mt,t),this.getVitalsData(Rt,t),this.getBasicPerformanceData(t)},e.prototype.filterResourceEntry=function(t){var e=this.getConfig().requestUrl;return!!["navigation","resource"].includes(t.entryType)&&(!["beacon"].includes(t.initiatorType)&&!(!t.name||t.name===e||t.name.includes("hubble.netease.com")||t.name.includes("sigma-scout-oaco")))},e.prototype.getResourceTiming=function(t){var e,n=this;"function"==typeof(null===(e=window.performance)||void 0===e?void 0:e.getEntriesByType)&&t(window.performance.getEntries().filter(function(t){return n.filterResourceEntry(t)}))},e.prototype.tapResourceTiming=function(t){var e=this;void 0!==window.PerformanceObserver&&(new PerformanceObserver(function(n){var r=n.getEntries().filter(function(t){return e.filterResourceEntry(t)});t(r)}).observe({entryTypes:["resource"]}),void 0!==window.performance&&(window.performance.onresourcetimingbufferfull=zt))},e}(it);function zt(){void 0!==window.performance&&("function"==typeof performance.clearResourceTimings&&performance.clearResourceTimings())}var Gt=function(){function t(t){var e=[];return{type:t,add:function(t){if("function"==typeof t)return e.push(t),function(){var n=e.indexOf(t);n>-1&&e.splice(n,1)}},get:function(){return e}}}return function(e){var n=t("load"),r=t("error"),o="pending";function i(t,e){if(o===t.type)e();else if("pending"===o)return t.add(e)}function a(t){o=t.type;for(var e=t.get();e.length;)e.shift()()}var s=i.bind(null,n),u=i.bind(null,r);e.onLoad&&s(e.onLoad),e.onError&&u(e.onError);var c="string"==typeof e.src?[e.src]:e.src.slice();return function t(){var o=c.shift(),i=document.createElement("script");i.onload=a.bind(null,n),i.onerror=c.length?t:a.bind(null,r),i.src=o,e.attr&&Object.keys(e.attr).forEach(function(t){i.setAttribute(t,e.attr[t])}),("head"===e.injectTo?document.head:document.body).appendChild(i)}(),{onLoad:s,onError:u}}}();function Jt(){return Y(this,void 0,void 0,function(){return Z(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),function(t){for(var e,n={},r=/[?&]([^=#]+)=([^&#]*)/g;e=r.exec(t||window.location.href);)n[decodeURIComponent(e[1])]=decodeURIComponent(e[2]);return n}().spyDebugger?[4,new Promise(function(t,e){Gt({src:"https://unpkg.oa.netease.com/@scout/remote-debug/dist/scout-remote.iife.min.js",crossorigin:"anonymous",injectTo:"head",onLoad:function(){window.ScoutRemoteDebug&&new window.ScoutRemoteDebug,t(!0)},onError:function(){t(!1)}})})]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2,!0];case 3:return t.sent(),[2,!1];case 4:return[2]}})})}var Wt="__SCOUT_DEVICE_ID__";var Xt=!1,Qt=function(){function t(){var t;this.config={},this.hub=null,this.timer=-1,this.delay=1500,this.isClosed=!1,this.env={isSelfWindow:!0,incognito:!1,deviceID:(t=window.localStorage.getItem(Wt)||l(),window.localStorage.setItem(Wt,t),t)}}return t.prototype.isInEffectHost=function(){var t=!0;if(void 0!==this.config.effectHosts){var e=h(this.config.effectHosts),n=window.location.host;t=e.some(function(t){return"string"==typeof t||t instanceof String?t===n:"[object RegExp]"===Object.prototype.toString.call(t)?!!n.match(t):"function"==typeof t&&t()})}return t},t.prototype.init=function(t){var e=et(et([],tt(lt.excludeUrls),!1),tt(t.excludeUrls||[]),!1),n=et(et([],tt(lt.ignoreErrors),!1),tt(t.ignoreErrors||[]),!1);this.config=K(K({enabled:lt.enabled,limitPaths:lt.limitPaths,limitTimeout:lt.limitTimeout,errorRepeat:lt.errorRepeat,maxBreadcrumbs:lt.maxBreadcrumbs,maxErrors:lt.maxErrors,requestLogLevel:lt.requestLogLevel},t),{instrumentEnable:K(K({},lt.instrumentEnable),t.instrumentEnable),excludeUrls:e,ignoreErrors:n}),Jt(),this.client=new Vt(this.config,Ht),this.hub=new at(this.client),this.logger=new ft(this.hub),this.record=t.record,this.isInEffectHost()&&this.config.enabled&&(this.addGlobalHandlers(),this.run(),this.processPreError())},t.prototype.setUserData=function(t){void 0!==t.userName&&null!==t.userName?this.hub.setUserData(t):A.warn("userData must has userName prop")},t.prototype.setMetaData=function(t){this.hub.setMetaData(t)},t.prototype.captureError=function(t,e){var n=this.isInEffectHost();t&&t.toString?(n||e)&&this.client.sendErrors(this.hub.captureError(t),this.getExtraData(!0,!0)):A.warn("error is not valid")},t.prototype.captureMessage=function(t,e){var n=this.isInEffectHost();void 0===t?A.warn("message should be a string"):(n||e)&&this.client.sendMsg({msg:t,type:"custom"},this.getExtraData())},t.prototype.addGlobalHandlers=function(){this.initOnce()},t.prototype.getExtraData=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);var n={metaData:K(K({},this.hub.metaData),this.env),paths:this.hub.paths.slice(0,this.config.limitPaths),userData:this.hub.userData};return t&&(n.events=this.hub.interactions),e&&(n.spans=this.hub.spans),n},t.prototype.close=function(){this.isClosed=!0,clearInterval(this.timer)},t.prototype.run=function(){var t=this;this.isClosed=!1,clearInterval(this.timer);var e=this.config.errorRepeat,n=void 0===e?3:e;this.timer=setInterval(function(){var e=z(t.hub.flush()),r=t.hub.breadcrumbs;e.length>0&&t.client.sendErrors(e,K(K({},t.getExtraData(!0,!0)),{breadcrumbs:r}));var o=t.client.popFailRequest();0===t.client.getRequestBuffersLen()&&o&&(!o.repeat||o.repeat<=n)&&t.client._sendData(o,!0);var i=t.hub.flushMessage();i.length>0&&t.client.sendMsg(i,K(K({},t.getExtraData(!1)),{breadcrumbs:t.hub.breadcrumbs}));var a=t.hub.flushRequestLogs();a.length>0&&t.client.sendRequestLog(a,t.getExtraData(!1,!1))},this.delay)},t.prototype.processPreError=function(){var t=this;Array.isArray(window.__scout_pre_error_queue__)&&this.hub&&(window.__scout_pre_error_queue__.forEach(function(e){"unhandledrejection"===e.type||e instanceof PromiseRejectionEvent?t.hub.addErrors(e):t.hub.addErrors({msg:e.message,error:e.error,lineno:e.lineno,colno:e.colno})}),window.__scout_pre_error_queue__=[]),window.removeEventListener("unhandledrejection",window.ScoutPrecollectError),window.removeEventListener("error",window.ScoutPrecollectError)},t.prototype.initOnce=function(){var t=this;if(!Xt){Xt=!0,X().then(function(e){var n=e.isPrivate;t.env=K(K({},t.env),{isSelfWindow:window.top===window.self,incognito:n})}).catch(function(t){A.error(t)});var e=this.client.getConfig().instrumentEnable;return document.referrer&&this.hub.addPath(document.referrer),this.hub.addPath(window.location.href),e&&!e.error||F({type:"error",callback:function(e,n,r,o){t.isClosed||t.hub.addErrors({msg:e,lineno:n,colno:r,error:o})}}),e&&!e.unhandledrejection||F({type:"unhandledrejection",callback:function(e){var n;A.log("unhandledrejection",e.reason),t.isClosed||(null===(n=e.reason)||void 0===n?void 0:n.isRepeat)||t.hub.addErrors(e)}}),e&&!e.history||F({type:"history",callback:function(){t.isClosed||t.hub.addPath(location.href)}}),e&&!e.hash||F({type:"hash",callback:function(){t.isClosed||(t.hub.flushSpans(),t.hub.addPath(location.href))}}),e&&!e.console||F({type:"console",callback:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.isClosed||t.hub.addMessage({type:e[1],msg:e[0]})}}),e&&!e.fetch||(F({type:"fetch",callback:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.hub.captureRequestLog(e[0],"fetch")}}),F({type:"stack-fetch",callback:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.hub.capturePendingRequest(e[0],"fetch")}})),e&&!e.xhr||(F({type:"xhr",callback:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.hub.captureRequestLog(e[0],"xhr")}}),F({type:"stack-xhr",callback:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.hub.capturePendingRequest(e[0],"xhr")}})),e&&!e.dom||F({type:"dom",callback:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.hub.captureDOM(e[0])}}),"function"==typeof this.record&&this.record({emit:function(e,n){n&&t.hub.flushInterAction(),t.isClosed||t.hub.addInteraction(e,t.config.recordAll)},checkoutEveryNms:3e5}),this.getPerformance(),e&&!e.resourceTiming||(this.client.getResourceTiming(function(e){return t.hub.captureResourceTimings(e)}),this.client.tapResourceTiming(function(e){return t.hub.captureResourceTimings(e)}),window.setInterval(function(){var e=t.hub.flushResourceTimings(t.client.maxResourceSize);t.client.sendResourceTiming(e,t.getExtraData(!1))},1e3)),window.addEventListener("unload",function(){if(!e||e.fetch||e.xhr){var n=t.hub.flushPendingRequest();n.length>0&&t.client.sendRequestLog(n.map(function(t){return K(K({},t),{statusCode:-1})}),t.getExtraData(!1,!1))}if(!e||e.error||e.unhandledrejection){var r=z(t.hub.flush()),o=t.hub.breadcrumbs;r.length>0&&t.client.sendErrors(r,K(K({},t.getExtraData(!0,!0)),{breadcrumbs:o}))}}),this}},t.prototype.getPerformance=function(){this.client.getPerformanceData(this.getExtraData(!1))},t.prototype.getGlobalScout=function(){return window.Scout},t}(),$t=new Qt;"object"==typeof window&&(window.Scout=$t,window.ScoutLog=A,A.info(window.Scout))}();
